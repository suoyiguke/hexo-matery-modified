---
title: mysql-分表.md
top: false
cover: false
toc: true
mathjax: true
date: 2022-03-20 18:16:49
password:
summary:
tags: mysql基本
categories: mysql基本
---
---
title: mysql-分表.md
top: false
cover: false
toc: true
mathjax: true
date: 2022-03-20 18:16:49
password:
summary:
tags: mysql基本
categories: mysql基本
---
###垂直分表
解决单表列数过多或大字段性能问题问题，按照列划分为几个小的数据表。如果一张表中有一个大字段，而且并不是必须要展示的或者不是当前需要用的，那么虽然没有刻意去查询，但是在根据id或者其他索引进行查询的时候就会把大字段一起查出来，会严重影响查询的性能，所以才有的垂直分表。

>比如说，文章表中有一个text类型的字段做文章详情。这时候就可以单独将之分到一个文章详情表中。



###水平分表
解决数据量过大问题，把数据存储到结构相同的不同表中。比如3000万订单数据，分别存放到三张表中，每张表存放1000万数据。

######水平分表策略
1、一致性Hash：例如订单表，可以按照订单userid字段进行哈希取模算法，路由映射到不同表或数据库中。一致性Hash数据存储具有随机性。

2、范围切分：按照某个字段（例如ID）在某个维度区间将数据路由映射到不同表或数据库中。例如ID=0~100000之间的数据保存奥数据库DB1，ID=100001~200000之间的数据保存至数据库DB2。范围切分能保证数据是连续的。

3、日期拆分：例如当前一年的业务数据存放到生产库，将一年前的数据备份至备份库中。





###id重复的解决方案
借用第三方应用如memcache、redis的id自增器
单独建一张只包含id一个字段的表，每次自增该字段作为数据记录的id
